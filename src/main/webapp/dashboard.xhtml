<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
      
      <h:head>
      	<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
      	<title>Dashboard </title>
      	
      </h:head>
      <h:body>
      	<f:metadata>
        	<f:event type="preRenderView" listener="#{dashboardBean.initDashboard()}" />
    	</f:metadata>
      	<h:outputText value="Welcome, #{dashboardBean.firstName}"> </h:outputText>
		<table style="border: 1px solid black">
			<tr>
				<td>
					<h:form>
						<h:commandButton value="Logout" action="#{dashboardBean.logout}"></h:commandButton>
						<input type="button" value="Back" onclick="window.history.back();" />
						
					</h:form>
					
				</td>
			</tr>
			<tr style="">
				<td style="padding: 10px; vertical-align: top; width: 5%">
					<h:form id="addPetForm" enctype="multipart/form-data">
							<br />
							<h:commandButton id="addPet" value="#{dashboardBean.showAddPet ? 'Close' : 'Add Pet'}"
								action="#{dashboardBean.addPet}" immediate="true" >
								<f:ajax execute="@this" render="@this addPetFormPanel" />
								
							</h:commandButton>
							<br />
							<h:commandButton id="viewRequests" value="#{dashboardBean.showViewRequests ? 'Close' : 'View Recieved Requests'}"
								action="#{dashboardBean.viewRequests}" immediate="true" >
								<f:ajax render="@this addViewRequestsFormPanel " />
								
							</h:commandButton>
							<br />
							<h:commandButton id="viewSentRequests" value="#{dashboardBean.showViewSentRequests ? 'Close' : 'View Sent Requests'}"
								action="#{dashboardBean.viewSentRequests}" immediate="true" >
								<f:ajax render="@this addViewSentRequestsFormPanel " />
								
							</h:commandButton>
							<br />
							<h:form>
								<h:commandButton id="viewPets" value="viewPets"
									action="view_pets.xhtml?faces-redirect=true">
								</h:commandButton>
							</h:form>
							<br />
		
							<h:panelGroup id="addPetFormPanel">
								<h:panelGroup rendered="#{dashboardBean.showAddPet}">
			
									<h:outputLabel for="petName">Enter pet name: </h:outputLabel>
									<h:inputText id="petName" required="true"
										requiredMessage="Required"
										validator="#{dashboardBean.petNameValidator}" resetInput="true"></h:inputText>
									<h:message for="petName" />
									<br />
			
									<h:outputLabel for="petGender">Choose pet gender: </h:outputLabel>
									<h:selectOneMenu value="#{dashboardBean.petGender}"
										resetInput="true">
										<f:selectItems value="#{dashboardBean.gendersOptions}" />
									</h:selectOneMenu>
									<br />
			
									<h:outputLabel for="petCategory">Choose pet category: </h:outputLabel>
									<h:selectOneMenu id="petCategory"
										value="#{dashboardBean.petCategory}" resetInput="true">
										<f:selectItems value="#{dashboardBean.categoriesOptions}" />
									</h:selectOneMenu>
									<br />
			
									<h:outputLabel for="petAge">Enter pet age: </h:outputLabel>
									<h:selectOneMenu id="petAge" value="#{dashboardBean.petAge}"
										resetInput="true">
										<f:selectItems value="#{dashboardBean.sizeOptions}" />
									</h:selectOneMenu>
									<br />
			
									<h:outputLabel for="petHeight">Enter pet height: </h:outputLabel>
									<h:selectOneMenu id="petHeight" value="#{dashboardBean.petHeight}"
										resetInput="true">
										<f:selectItems value="#{dashboardBean.sizeOptions}" />
									</h:selectOneMenu>
									<br />
			
									<h:outputLabel for="petWeight">Enter pet weight: </h:outputLabel>
									<h:selectOneMenu id="petWeight" value="#{dashboardBean.petWeight}"
										resetInput="true">
										<f:selectItems value="#{dashboardBean.sizeOptions}" />
									</h:selectOneMenu>
									<br />
			
									<h:outputLabel for="petLength">Enter pet length: </h:outputLabel>
									<h:selectOneMenu id="petLength" value="#{dashboardBean.petLength}"
										resetInput="true">
										<f:selectItems value="#{dashboardBean.sizeOptions}" />
									</h:selectOneMenu>
									<br />
			
									<h:outputLabel for="petShortDesc">Enter short description of the pet: </h:outputLabel>
									<h:inputTextarea id="petShortDesc"
										value="#{dashboardBean.shortDescription}" required="true"
										requiredMessage="Required" resetInput="true"></h:inputTextarea>
			
									<br />
			
									<h:outputLabel for="petFullDesc">Enter full description of the pet: </h:outputLabel>
									<h:inputTextarea id="petFullDesc"
										value="#{dashboardBean.fullDescription}" required="true"
										requiredMessage="Required" resetInput="true"></h:inputTextarea>
			
									<br />
			
									<h:outputLabel for="petPhoto">Choose photo of the pet: </h:outputLabel>
									<h:inputFile id="petPhoto" value="#{dashboardBean.petPhoto}"
										required="true"></h:inputFile>
			
									<br />
									
									
									<br/>
									<h:commandButton id="submitPet" value="Submit"
										action="#{dashboardBean.addNewPet}">
										<f:resetValues render="addPetForm:petName" />
									</h:commandButton>
								</h:panelGroup>
							</h:panelGroup>
							<br/>
							<h:panelGroup id="addViewRequestsFormPanel">
								<h:panelGroup rendered="#{dashboardBean.showViewRequests}">
									<ui:repeat value="#{dashboardBean.adoptionRequests}" var="adoptionRequest">
										<div style="flex: 0 0 33.33%; padding: 10px; border: 1px solid black">
									        <b>Pet Name:</b> #{adoptionRequest.petName}<br /> 
							                <p>Requester Name: #{adoptionRequest.requesterName}</p>
									        <p>Requester Address: #{adoptionRequest.requesterAddress}</p>
									        <p>Requester Phone: #{adoptionRequest.requesterPhone}</p>
									        <p>Request Message: #{adoptionRequest.requestMessage}</p>
									    </div>
									</ui:repeat>
							        <h:outputLabel value="No adoption requests found" rendered="#{empty dashboardBean.adoptionRequests}" />
								</h:panelGroup>
							</h:panelGroup>
							<h:panelGroup id="addViewSentRequestsFormPanel">
								<h:panelGroup rendered="#{dashboardBean.showViewSentRequests}">
									<ui:repeat value="#{dashboardBean.sentRequests}" var="sentRequest">
										<div style="flex: 0 0 33.33%; padding: 10px; border: 1px solid black">
									        <b>Pet Name:</b> #{sentRequest.petName}<br /> 
							                <p>Owner Name: #{sentRequest.ownerName}</p>
									        <p>Owner Address: #{sentRequest.ownerAddress}</p>
									        <p>Owner Phone: #{sentRequest.ownerPhone}</p>
									        <p>Your Message: #{sentRequest.requestMessage}</p>
									    </div>
									</ui:repeat>
							        <h:outputLabel value="You did'nt make adoption requests" rendered="#{empty dashboardBean.sentRequests}" />
								</h:panelGroup>
							</h:panelGroup>
						</h:form>
					</td>
					<td>
						<h:form enctype="multipart/form-data"
								style="display: flex; flex-wrap: wrap;">
								<ui:repeat value="#{dashboardBean.petsList}" var="pet">
									<div style="flex: 0 0 33.33%; padding: 10px; border: 1px solid black">
										<b>Name:</b> #{pet.name}<br /> 
										<b>Age:</b> #{pet.age}<br /> 
										<b>Gender:</b>#{pet.genderString}<br /> 
										<b>Weight:</b> #{pet.weight}<br /> 
										<b>Height:</b>#{pet.height}<br /> 
										<b>Length:</b> #{pet.length}<br /> 
										<b>Short Description:</b> #{pet.shortDescription}<br /> 
										<b>Full Description:</b> #{pet.fullDescription}<br /> 
										<b>Photo:</b>#{pet.photo}<br />
										
										<h:graphicImage library="images" name="#{pet.photo}"  alt="Refresh the page if the photo isnt loading" style="width: 100px; height:100px;"/>
										
										<br />
										<h:commandButton value="Remove pet"
											action="#{dashboardBean.removePet}">
											<f:param name="petName" value="#{pet.name}" />
										</h:commandButton>
									</div>
								</ui:repeat>
							</h:form>
					</td>
	
			</tr>
		</table>

	</h:body>
      
      
</html>