<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
      
      <h:head>
      
      
      </h:head>
      <h:body>
	      
	      	<table style="border: 1px solid black">
			<tr>
				<td>
					<h:panelGroup rendered="#{petsBean.isUser}">
					<h:form>
						<h:commandButton value="Logout" action="#{dashboardBean.logout}"></h:commandButton> <br/>
					</h:form>
					</h:panelGroup>
					<f:event type="preRenderView" listener="#{petsBean.checkSession()}" />
				</td>
			</tr>
			<tr style="">
				<td style="padding: 10px; ">
					<h:form>
						<input type="button" value="Back" onclick="window.history.back();" />
					    <h:selectOneRadio value="#{petsBean.selectCategory}">
					        <f:selectItems value="#{petsBean.petCategories}" />
					        <f:selectItem itemValue=" " itemLabel="All" />
					        <f:ajax render="allPets" />
					    </h:selectOneRadio>
					
					</h:form>
					<h:form id="allPets" enctype="multipart/form-data">
						<ui:repeat id="petsTable" value="#{petsBean.allPets}" var="pet" >
							<h:panelGroup rendered="#{petsBean.selectCategory eq ' ' or pet.category eq petsBean.selectCategory}">
							<div style="border: 1px solid black">
		               			<h:outputText value = "Name: #{pet.name}"/><br/>
				            	<h:outputText value="Age: #{pet.age}" /><br/>
				            	<h:outputText value="Category: #{pet.category}" /><br/>
				            	<h:outputText value="Short Description: #{pet.shortDescription}" /><br/>
								<h:graphicImage library="images" name="#{pet.photo}" style="width: 100px; height:100px;"/><br/>
			            	  	<h:commandButton value="View Pet" action="#{petsBean.viewPet}" >
			            			<f:param name="id" value="#{pet.id}" />	
			            			
			            		</h:commandButton>
								<br/>
							</div>
						
							</h:panelGroup>
	           		 	</ui:repeat>
	           		 	
					</h:form>
					</td>
					<td >
						<h:panelGroup id="viewPetDetails" rendered="#{petsBean.showPet}" value="#{petsBean.viewPet}" var="pet">
							<h:form id="view" enctype="multipart/form-data" immediate="true" style="display: flex; flex-wrap: wrap;">  
							 
											<div style="flex: 0 0 60%; padding: 10px; border: 1px solid black">
												<b>Name:</b> #{pet.name}<br /> 
												<b>Category:</b> #{pet.category}<br /> 
												<b>Age:</b> #{pet.age}<br /> 
												<b>Gender:</b>#{pet.genderString}<br /> 
												<b>Weight:</b> #{pet.weight}<br /> 
												<b>Height:</b>#{pet.height}<br /> 
												<b>Length:</b> #{pet.length}<br /> 
												<b>Short Description:</b> #{pet.shortDescription}<br /> 
												<b>Full Description:</b> #{pet.fullDescription}<br /> 
												<h:graphicImage library="images" name="#{pet.photo}" style="width: 300px; height:300px;"/>
												<br/>
							            		<br/>
												<!-- TODO : FIX THIS BUTTON SO IT RENDERS THE NEXT FORM  -->
							            	  	<h:commandButton value="Close" action="#{petsBean.setShowPet}"/>
											</div>
										<br/>
										
							 
							</h:form>
							<h:panelGroup rendered="#{petsBean.isUser}">
								<h:form id="test" enctype="multipart/form-data">
									<h:commandButton value="Request Adoption" action="#{petsBean.requestAdoption}"  >
										<f:param name="id" value="#{pet.id}" />
										<f:ajax execute="@this" render="requestAdoptionMessage"></f:ajax>
									</h:commandButton>
									<br/>
									<h:outputLabel id="requestAdoptionMessage" value="#{petsBean.message}"></h:outputLabel>
								</h:form>
							</h:panelGroup>
								
								 
								
						</h:panelGroup>
					</td>
					
	
			</tr>
		</table>
		
			
      </h:body>
      
      
</html>